<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Order Dashboard</title>
<style>
body {
  font-family: Arial, sans-serif;
  padding: 20px;
  background: #f7f7f7;
}
h1 {
  text-align: center;
  margin-bottom: 20px;
}
table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  border-radius: 8px;
  overflow: hidden;
}
th, td {
  padding: 12px 15px;
  text-align: center;
  border-bottom: 1px solid #eee;
}
th {
  background-color: #f39237; /* header color */
  color: #fff;
  text-transform: uppercase;
}
tr:hover {
  background-color: #f5f5f5;
}
td:last-child {
  text-align: left;
}
</style>
</head>
<body>
<h1>Order Dashboard</h1>

<table>
  <thead>
    <tr>
      <th>Order ID</th>
      <th>Customer Name</th>
      <th>Product Name</th>
      <th>Quantity</th>
      <th>Address</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody id="ordersTableBody">
    <!-- Orders will be inserted here -->
  </tbody>
</table>

<script>
async function loadOrders() {
  try {
    const res = await fetch('http://localhost:3000/api/orders', {
      headers: { 'Authorization': 'Bearer ' + localStorage.getItem('adminToken') }
    });
    const orders = await res.json();
    const tbody = document.getElementById('ordersTableBody');
    tbody.innerHTML = '';

    // Sort by ID ascending
    orders.sort((a,b) => a.id - b.id);

    orders.forEach(o => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>#${o.id}</td>
        <td>${o.user_name}</td>
        <td>${o.product_name}</td>
        <td>${o.quantity}</td>
        <td>${o.address_line}</td>
        <td>${o.created_at || '-'}</td>
      `;
      tbody.appendChild(tr);
    });
  } catch (err) {
    console.error('Error fetching orders:', err);
  }
}

// Initial load and refresh every 5 seconds
loadOrders();
setInterval(loadOrders, 5000);
</script>
</body>
</html>
